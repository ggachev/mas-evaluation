{"id": 85, "timestamp": "2025-12-13T15:49:06.369339", "source": "agent", "message": "I read the file /workspace/matplotlib/lib/matplotlib/testing/conftest.py.", "cause": 84, "observation": "read", "tool_call_metadata": {"function_name": "str_replace_editor", "tool_call_id": "call_qmX4DyRaARrkUVxMvz1PLoIt", "model_response": {"id": "chatcmpl-CmM9ECiyLfluTGr8CCaMaC8wXp8sI", "created": 1765640916, "model": "gpt-5-mini-2025-08-07", "object": "chat.completion", "system_fingerprint": null, "choices": [{"finish_reason": "tool_calls", "index": 0, "message": {"content": null, "role": "assistant", "tool_calls": [{"function": {"arguments": "{\"command\":\"view\",\"path\":\"/workspace/matplotlib/lib/matplotlib/testing/conftest.py\",\"view_range\":[1,200],\"security_risk\":\"LOW\"}", "name": "str_replace_editor"}, "id": "call_qmX4DyRaARrkUVxMvz1PLoIt", "type": "function"}], "function_call": null, "annotations": []}, "provider_specific_fields": {}}], "usage": {"completion_tokens": 1974, "prompt_tokens": 46524, "total_tokens": 48498, "completion_tokens_details": {"accepted_prediction_tokens": 0, "audio_tokens": 0, "reasoning_tokens": 1920, "rejected_prediction_tokens": 0, "text_tokens": null}, "prompt_tokens_details": {"audio_tokens": 0, "cached_tokens": 44288, "text_tokens": null, "image_tokens": null}}, "service_tier": "default"}, "total_calls_in_response": 1}, "content": "NOTE: We only show up to 132 since there're only 132 lines in this file.\nHere's the result of running `cat -n` on /workspace/matplotlib/lib/matplotlib/testing/conftest.py:\n     1\timport pytest\n     2\timport sys\n     3\timport matplotlib\n     4\tfrom matplotlib import _api, cbook\n     5\t\n     6\t\n     7\tdef pytest_configure(config):\n     8\t    # config is initialized here rather than in pytest.ini so that `pytest\n     9\t    # --pyargs matplotlib` (which would not find pytest.ini) works.  The only\n    10\t    # entries in pytest.ini set minversion (which is checked earlier),\n    11\t    # testpaths/python_files, as they are required to properly find the tests\n    12\t    for key, value in [\n    13\t        (\"markers\", \"flaky: (Provided by pytest-rerunfailures.)\"),\n    14\t        (\"markers\", \"timeout: (Provided by pytest-timeout.)\"),\n    15\t        (\"markers\", \"backend: Set alternate Matplotlib backend temporarily.\"),\n    16\t        (\"markers\",\n    17\t         \"style: Set alternate Matplotlib style temporarily (deprecated).\"),\n    18\t        (\"markers\", \"baseline_images: Compare output against references.\"),\n    19\t        (\"markers\", \"pytz: Tests that require pytz to be installed.\"),\n    20\t        (\"filterwarnings\", \"error\"),\n    21\t        (\"filterwarnings\",\n    22\t         \"ignore:.*The py23 module has been deprecated:DeprecationWarning\"),\n    23\t        (\"filterwarnings\",\n    24\t         r\"ignore:DynamicImporter.find_spec\\(\\) not found; \"\n    25\t         r\"falling back to find_module\\(\\):ImportWarning\"),\n    26\t    ]:\n    27\t        config.addinivalue_line(key, value)\n    28\t\n    29\t    matplotlib.use('agg', force=True)\n    30\t    matplotlib._called_from_pytest = True\n    31\t    matplotlib._init_tests()\n    32\t\n    33\t\n    34\tdef pytest_unconfigure(config):\n    35\t    matplotlib._called_from_pytest = False\n    36\t\n    37\t\n    38\t@pytest.fixture(autouse=True)\n    39\tdef mpl_test_settings(request):\n    40\t    from matplotlib.testing.decorators import _cleanup_cm\n    41\t\n    42\t    with _cleanup_cm():\n    43\t\n    44\t        backend = None\n    45\t        backend_marker = request.node.get_closest_marker('backend')\n    46\t        prev_backend = matplotlib.get_backend()\n    47\t        if backend_marker is not None:\n    48\t            assert len(backend_marker.args) == 1, \\\n    49\t                \"Marker 'backend' must specify 1 backend.\"\n    50\t            backend, = backend_marker.args\n    51\t            skip_on_importerror = backend_marker.kwargs.get(\n    52\t                'skip_on_importerror', False)\n    53\t\n    54\t            # special case Qt backend importing to avoid conflicts\n    55\t            if backend.lower().startswith('qt5'):\n    56\t                if any(sys.modules.get(k) for k in ('PyQt4', 'PySide')):\n    57\t                    pytest.skip('Qt4 binding already imported')\n    58\t\n    59\t        # Default of cleanup and image_comparison too.\n    60\t        style = [\"classic\", \"_classic_test_patch\"]\n    61\t        style_marker = request.node.get_closest_marker('style')\n    62\t        if style_marker is not None:\n    63\t            assert len(style_marker.args) == 1, \\\n    64\t                \"Marker 'style' must specify 1 style.\"\n    65\t            _api.warn_deprecated(\"3.5\", name=\"style\", obj_type=\"pytest marker\",\n    66\t                                 alternative=\"@mpl.style.context(...)\")\n    67\t            style, = style_marker.args\n    68\t\n    69\t        matplotlib.testing.setup()\n    70\t        with _api.suppress_matplotlib_deprecation_warning():\n    71\t            if backend is not None:\n    72\t                # This import must come after setup() so it doesn't load the\n    73\t                # default backend prematurely.\n    74\t                import matplotlib.pyplot as plt\n    75\t                try:\n    76\t                    plt.switch_backend(backend)\n    77\t                except ImportError as exc:\n    78\t                    # Should only occur for the cairo backend tests, if neither\n    79\t                    # pycairo nor cairocffi are installed.\n    80\t                    if 'cairo' in backend.lower() or skip_on_importerror:\n    81\t                        pytest.skip(\"Failed to switch to backend {} ({}).\"\n    82\t                                    .format(backend, exc))\n    83\t                    else:\n    84\t                        raise\n    85\t            matplotlib.style.use(style)\n    86\t        try:\n    87\t            yield\n    88\t        finally:\n    89\t            matplotlib.use(prev_backend)\n    90\t\n    91\t\n    92\t@pytest.fixture\n    93\t@_api.deprecated(\"3.5\", alternative=\"none\")\n    94\tdef mpl_image_comparison_parameters(request, extension):\n    95\t    # This fixture is applied automatically by the image_comparison decorator.\n    96\t    #\n    97\t    # The sole purpose of this fixture is to provide an indirect method of\n    98\t    # obtaining parameters *without* modifying the decorated function\n    99\t    # signature. In this way, the function signature can stay the same and\n   100\t    # pytest won't get confused.\n   101\t    # We annotate the decorated function with any parameters captured by this\n   102\t    # fixture so that they can be used by the wrapper in image_comparison.\n   103\t    baseline_images, = request.node.get_closest_marker('baseline_images').args\n   104\t    if baseline_images is None:\n   105\t        # Allow baseline image list to be produced on the fly based on current\n   106\t        # parametrization.\n   107\t        baseline_images = request.getfixturevalue('baseline_images')\n   108\t\n   109\t    func = request.function\n   110\t    with cbook._setattr_cm(func.__wrapped__,\n   111\t                           parameters=(baseline_images, extension)):\n   112\t        yield\n   113\t\n   114\t\n   115\t@pytest.fixture\n   116\tdef pd():\n   117\t    \"\"\"Fixture to import and configure pandas.\"\"\"\n   118\t    pd = pytest.importorskip('pandas')\n   119\t    try:\n   120\t        from pandas.plotting import (\n   121\t            deregister_matplotlib_converters as deregister)\n   122\t        deregister()\n   123\t    except ImportError:\n   124\t        pass\n   125\t    return pd\n   126\t\n   127\t\n   128\t@pytest.fixture\n   129\tdef xr():\n   130\t    \"\"\"Fixture to import xarray.\"\"\"\n   131\t    xr = pytest.importorskip('xarray')\n   132\t    return xr\n", "extras": {"path": "/workspace/matplotlib/lib/matplotlib/testing/conftest.py", "impl_source": "oh_aci"}}